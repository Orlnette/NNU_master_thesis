%%----------- 格式控制 ----------- %%
\documentclass[12pt, a4paper]{article}

%%----------- 引入宏包 ----------- %%
\usepackage[numbers]{gbt7714}
\usepackage[heading]{ctex}
\usepackage{xeCJK}
\usepackage[hidelinks]{hyperref}
\usepackage[final]{pdfpages}
\usepackage{natbib}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{fontspec}
\usepackage{fancyhdr}
\usepackage{caption}
\usepackage{titletoc}
\usepackage{titlesec}
\usepackage{amssymb}
\usepackage{siunitx}

%%----------- 页面设置 ----------- %%
\geometry{left=2.5cm, right=2.5cm, top=3cm, bottom=3cm}
\setlength{\baselineskip}{20pt}
\setlength{\headheight}{15pt}

%%----------- 字体设置 ----------- %%
\setmainfont{Times New Roman}
\newCJKfontfamily{\cusong}[AutoFakeBold={2.17}]{SimSun} % 本地编译粗宋体
\setCJKfamilyfont{song}{SimSun}
\setCJKfamilyfont{hei}{黑体\-简.TTF}

%%----------- 目录设置 ----------- %%
\titlecontents{section}[0pt]{\addvspace{0pt}\filright}
{\contentspush{\thecontentslabel\ \ }}
{}{\titlerule*[4pt]{.}\contentspage}

\titlecontents{subsection}[1.7em]{\addvspace{0pt}\filright}
{\contentspush{\thecontentslabel\ \ }}
{}{\titlerule*[4pt]{.}\contentspage}

\titlecontents{subsubsection}[3em]{\addvspace{0pt}\filright}
{\contentspush{\thecontentslabel\ \ }}
{}{\titlerule*[4pt]{.}\contentspage}

\titlecontents{figure}[0pt]{\addvspace{0pt}\filright}
{\figurename~\thecontentslabel\ \ }{}{\titlerule*[4pt]{.}\contentspage}

\titlecontents{table}[0pt]{\addvspace{0pt}\filright}
{\tablename~\thecontentslabel\ \ }{}{\titlerule*[4pt]{.}\contentspage}

\renewcommand{\listfigurename}{图目录}
\renewcommand{\listtablename}{表目录}
\setcounter{secnumdepth}{4}

%%----------- 标题设置 ----------- %%
\titleformat{\section}{\centering\bfseries\heiti\zihao{3}}{\thesection}{1em}{\heiti\zihao{3}}
\titleformat{\subsection}{\bfseries\heiti\zihao{4}}{{\thesubsection}}{0.5em}{\heiti\zihao{4}}
\titleformat{\subsubsection}{\bfseries\heiti\zihao{-4}}{{\thesubsubsection}}{0.5em}{\heiti\zihao{-4}}
\titleformat{\paragraph}[hang]{\zihao{-4}}{\theparagraph}{0.5em}{\zihao{-4}}

\titlespacing{\section}{6pt}{*2}{*2}
\titlespacing{\subsection}{0pt}{4pt}{6pt}
\titlespacing{\subsubsection}{0pt}{6pt}{6pt}
\titlespacing{\paragraph}{0pt}{6pt}{6pt}

%%----------- 编号设置 ----------- %%
\renewcommand{\thesection}{第\arabic{section}章}
\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}
\renewcommand{\theparagraph}{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}.\arabic{paragraph}}

\counterwithin{figure}{section}
\counterwithin{equation}{section}
\counterwithin{table}{section}
\renewcommand{\theequation}{\arabic{section}.\arabic{equation}}
\renewcommand{\thefigure}{\arabic{section}.\arabic{figure}}
\renewcommand{\thetable}{\arabic{section}.\arabic{table}}
\renewcommand{\figureautorefname}{图}
\renewcommand{\tableautorefname}{表}
\renewcommand{\arraystretch}{1.3}

\renewcommand{\headrulewidth}{0.05mm}

%%----------- 参考文献设置 ----------- %%
\renewcommand\refname{参考文献}
\setlength{\bibsep}{0pt}
\setcitestyle{super}
\newcommand{\upcite}[1]{\textsuperscript{\textsuperscript{\cite{#1}}}}

%%----------- Caption设置 ----------- %%
\captionsetup[figure]{aboveskip=6pt, labelformat=default, labelsep=space, font=small}
\captionsetup[table]{belowskip=12pt, aboveskip=6pt, labelformat=default, labelsep=space, font=small}

\begin{document}

%%----------- 前言部分 ----------- %%
\newgeometry{left=2.54cm, right=2.54cm, top=3.18cm, bottom=3.18cm}
\includepdf{cover/cover.pdf} % 封面文件
\input{pages/abstract} % 中英文摘要

%%----------- 页眉页脚设置 ----------- %%
\restoregeometry
\newpage
\pagestyle{fancy}
\fancyhf{}
\fancyhead[CO, CE]{\leftmark}
\fancyfoot[CO, CE]{\thepage}

%%----------- 目录格式 ----------- %%
\tableofcontents
\markboth{目录}{目录}
\newpage

% 图目录，不需要可以删掉
\listoffigures
\phantomsection
\addcontentsline{toc}{section}{图目录}
\newpage

% 表目录，不需要可以删掉
\listoftables
\phantomsection
\addcontentsline{toc}{section}{表目录}
\newpage

%%----------- 主体部分 ----------- %%
\pagenumbering{arabic}
\input{pages/Section1} % 第1章
\input{pages/Section2} % 第2章
\input{pages/Section3} % 第3章

%%----------- 结尾部分 ----------- %%
\input{pages/appendix} % 附录(如有)

\clearpage
\phantomsection
\addcontentsline{toc}{section}{参考文献} % 参考文献
\fancyhead[C]{参考文献}
\bibliography{ref/paper} % bib文件
\newpage

\input{pages/papers} % show time
\input{pages/thanks} % 致谢

\end{document}
